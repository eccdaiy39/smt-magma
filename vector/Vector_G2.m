/*The  VectorG2() function is provided by a Anonymous reviewer*/
function VectorG2(r,t,p,k,h2,v)
        u:=EulerPhi(k);
	B:=RMatrixSpace(Integers(), u,u)!0;
	B[1][1]:=r;
	for i:=2 to u do
	    B[i][1]:=-p^(i-1);B[i][i]:=1;
	end for;
	L:=LatticeWithBasis(B);
	S:=ShortestVectors(L);
	R<x>:=PolynomialRing(Integers());
	for i:=1 to #S do
	    C:=S[i];
	    b:=R!Eltseq(C);
	    h2d:=Resultant(b, x^2-t*x+p) div r;
	    if GCD(h2,h2d) eq 1 then
		return C;
	    end if;
	end for;
	min:=Norm(ShortestVector(L));max:=v*min;
	V:=ShortVectorsProcess(L, min, max);
	repeat
	    C:=NextVector(V);
	    if Norm(C) eq 0 then
	        return "NULL";
	    end if;
	    b:=R!Eltseq(C);
	    h2d:=Resultant(b, x^2-t*x+p) div r;
	until GCD(h2,h2d) eq 1;
	return C;
end function;

//*************************************Curve parmamters*************************//

printf("BN-P446:\n");
z:=2^110+2^36+1;
p:=36*z^4+36*z^3+24*z^2+6*z+1;
r:=36*z^4+36*z^3+18*z^2+6*z+1;
t:=6*z^2+1;
Fp:=GF(p);
F2<u>:=ExtensionField<Fp,u|u^2+1>;
Et:=EllipticCurve([F2|0,257*(u+5)]);
h2:=#Et div r;
v:=1;
k:=12;
VectorG2(r,t,p,k,h2,v);


printf("BLS12-P461:\n");
z:=-2^77+2^50+2^33;
p:=(z-1)^2*(z^4-z^2+1) div 3+z;
t:=z+1;
r:=z^4-z^2+1;
Fp:=GF(p);
F2<u>:=ExtensionField<Fp,u|u^2+1>;
Et:=EllipticCurve([F2|0,4*(2+u)]);
h2:=#Et div r;
v:=1;
k:=12;
VectorG2(r,t,p,k,h2,v);

printf("KSS16-P330:\n");
z:=-2^34+2^27-2^23+2^20-2^11+1;
r:=(z^8+48*z^4+625) div 61250;
t:=(2*z^5+41*z+35)div 35;
p:=(z^10+2*z^9+5*z^8+48*z^6+152*z^5+240*z^4+625*z^2+2398*z+3125) div 980;
Fp:=GF(p);
F4<u>:=ExtensionField<Fp,u|u^4-2>;
Et:=EllipticCurve([F4|1/u,0]);
h2:=#Et div r;
v:=2;
k:=16;
VectorG2(r,t,p,k,h2,v);

printf("KSS18-P348:\n");
z:=2^44+2^22-2^9+2;
x:=z div 7;
r:=Ceiling((z^6+37*z^3+343)/343);
t:=(z^4+16*z+7)div 7;
p:=Ceiling((z^8+5*z^7+7*z^6+37*z^5+188*z^4+259*z^3+343*z^2+1763*z+2401)/21);
Fp:=GF(p);
F3<u>:=ExtensionField<Fp,u|u^3+7>;
Et:=EllipticCurve([F3|0,3/u]);
ht:=#Et div r;
v:=1;
k:=18;
VectorG2(r,t,p,k,h2,v);

printf("KSS36-P798:\n");

z:=2^5 + 2^34 + 2^40 + 2^45-2^58;
p:=(z^14-4*z^13+7*z^12+683*z^8-2510*z^7+4781*z^6+117649*z^2-386569*z+823543) div 28749;
r:=(z^12+683*z^6+117649) div (7^6*37^2);
t:=(2*z^7+757*z+259) div 259;
h2:=3569264135135314029167490670315135087775619285709711985856808686871281692048923\
2062280284636949282597128519886731329073764703315261959265621830573166593601774\
9953896966720450863654152043664428499217529152597906124196756648166896090706342\
4615188214217563701655438207011609773929185178019949177971994577525407758337116\
0738204390476391217163507471758966317354337605355407885803634693196934279920025\
3962792743285487430269834937371075826422157560356306876080807805429783716075521\
0226341249585919580620784875886489712207223176097016171470641813021189334868144\
5625629494411118246822535046330259432216948981200152363153780393585469332950891\
3911550478495876633770300949806123481051048290869882550757048485132175250420957\
3277840986318699250303451992608469888795740583291492242748801909640911982419776\
3544897521429804307563788243618832674786286317278377498942950459404642934193305\
1934517210354707186736306884649468344660274737814982955004525227129946086912243\
3489158466831553258027991984893858147631793921404257400732834660757720575798442\
4673118114654210656360914834140813125965662345088127349022823171074284664854881\
2666760996514653975025488297580560448170971906923735238312403745267077857220136\
871476960827452265563491075415350434819207281403527637;
v:=2;
k:=36;
VectorG2(r,t,p,k,h2,v);

printf("CP6-P782:\n");
r:=0x1ae3a4617c510eac63b05c06ca1493b1a22d9f300f5138f1ef3622fba094800170b5d44300000008508c00000000001;
p:=0x3848c4d2263babf8941fe959283d8f526663bc5d176b746af0266a7223ee72023d07830c728d80f9d78bab3596c8617\
c579252a3fb77c79c13201ad533049cfe6a399c2f764a12c4024bee135c065f4d26b7545d85c16dfd424adace79b57b942ae9;
a:=5;
b:=177643151186516790382863290692950915068014681181467126498863360455358080553612741484667721912433055\
283128432363477772602471389343368505482431515345387347241915059533414034630400675716522612293083333920\
40104884438208594329793895206056414;
t:=0xcda91b419cd3f63a81dba4eb8fc81231d84f4491c1e1a4dfaf393e5c14beec4affbc93fba900003f8fbe3c000000007a6;
t2:=t^2-2*p;
t3:=t*t2-t*p;
/*By Proposition 2 (in the case d=2) in https://eprint.iacr.org/2006/110.pdf
the order of twisted curve over Fp^3 is (p^3+1+t3)*/
h2:=(p^3+1+t3)div r;
v:=3;
k:=6;
VectorG2(r,t,p,k,h2,v);


printf("BW6-P761:\n");
z:=0x8508C00000000001;
r:=(z^6-2*z^5+2*z^3+z+1) div 3;
t:=(13*z^6 - 23*z^5 - 9*z^4 + 35*z^3 + 10*z + 22) div 3;
p:=(103*z^12-379*z^11+250*z^10+691*z^9-911*z^8 - 79*z^7 + 623*z^6 
- 640*z^5 + 274*z^4 + 763*z^3 + 73*z^2 + 254*z + 229)div 9;
Fp:=GF(p);
Et:=EllipticCurve([Fp|0,4]);
h2:=#Et div r;
v:=1;
k:=6;
VectorG2(r,t,p,k,h2,v);

